<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Спаси друзей от крокодилов!</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden;
      font-family: Arial, sans-serif;
      touch-action: manipulation;
    }

    /* Фоновое изображение */
    .background-image {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: url('background.png');
      background-size: cover;
      background-position: center;
      z-index: -3;
    }

    /* Слои воды поверх фона */
    .water-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(30, 144, 255, 0.1);
      z-index: -2;
    }

    .water-surface {
      position: fixed;
      top: 0;
      left: 0;
      width: 200%;
      height: 200%;
      background: 
        radial-gradient(circle at 20% 30%, rgba(255, 255, 255, 0.1) 0%, transparent 20%),
        radial-gradient(circle at 80% 70%, rgba(255, 255, 255, 0.1) 0%, transparent 20%);
      animation: water-move 20s linear infinite;
      z-index: -1;
      opacity: 0.7;
      pointer-events: none;
    }

    @keyframes water-move {
      0% { transform: translate(0, 0); }
      100% { transform: translate(-50%, -50%); }
    }

    #game {
      position: relative;
      width: 100vw;
      height: 100vh;
      overflow: hidden;
    }

    #waves {
      position: absolute;
      width: 100%;
      height: 100%;
      pointer-events: none;
    }

    #friends {
      position: absolute;
      top: 50%;
      left: 50%;
      width: 240px;
      transform: translate(-50%, -50%);
      pointer-events: none;
      z-index: 10;
      animation: bobbing 3s infinite ease-in-out;
      filter: drop-shadow(0 0 10px rgba(255, 255, 255, 0.5));
    }

    @keyframes bobbing {
      0%, 100% { transform: translate(-50%, -50%) translateY(0); }
      50% { transform: translate(-50%, -50%) translateY(8px); }
    }

    /* Более плавная анимация вздрагивания друзей */
    @keyframes friends-shock {
      0%, 100% { transform: translate(-50%, -50%); }
      25% { transform: translate(-50%, -50%) translateX(-5px); }
      75% { transform: translate(-50%, -50%) translateX(5px); }
    }

    .friend-wave {
      position: absolute;
      width: 80px;
      height: 80px;
      border-radius: 50%;
      border: 2px solid rgba(255, 255, 255, 0.3);
      animation: wave 3s ease-out infinite;
      pointer-events: none;
      z-index: 1;
      transform: translate(-50%, -50%);
    }

    @keyframes wave {
      0% { transform: translate(-50%, -50%) scale(0.3); opacity: 1; }
      100% { transform: translate(-50%, -50%) scale(2); opacity: 0; }
    }

    .crocodile {
      width: 120px;
      animation: sway 2s infinite ease-in-out;
      display: block;
      cursor: pointer;
      transition: transform 0.2s;
      filter: drop-shadow(2px 4px 3px rgba(0, 0, 0, 0.3));
      z-index: 5;
      position: relative;
    }

    .crocodile:active {
      transform: scale(0.9);
    }

    @keyframes sway {
      0%, 100% { transform: rotate(0deg); }
      50% { transform: rotate(2deg); }
    }

    /* Следы от крокодилов */
    .croc-trail {
      position: absolute;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(135, 206, 250, 0.4), transparent 70%);
      filter: blur(5px);
      transform: translate(-50%, -50%);
      pointer-events: none;
      z-index: 2;
      animation: trail-fade 3s forwards;
    }

    @keyframes trail-fade {
      0% { opacity: 0.8; transform: translate(-50%, -50%) scale(0.8); }
      100% { opacity: 0; transform: translate(-50%, -50%) scale(1.5); }
    }

    /* Водные всплески */
    .splash {
      position: absolute;
      border-radius: 50%;
      border: 2px solid rgba(255, 255, 255, 0.6);
      pointer-events: none;
      z-index: 4;
      transform: translate(-50%, -50%);
    }

    .splash-1 {
      animation: splash-wave 1.2s ease-out forwards;
    }

    .splash-2 {
      animation: splash-wave 1.5s 0.1s ease-out forwards;
    }

    .splash-3 {
      animation: splash-wave 1.8s 0.2s ease-out forwards;
    }

    @keyframes splash-wave {
      0% { transform: translate(-50%, -50%) scale(0); opacity: 0.8; }
      100% { transform: translate(-50%, -50%) scale(3); opacity: 0; }
    }

    /* Остальные стили остаются без изменений */
    /* ... */
  </style>
</head>
<body>
  <div id="loading">
    <div>Загрузка игры...</div>
    <div id="progress" style="margin-top: 20px; width: 200px; height: 10px; background: #333; border-radius: 5px;">
      <div id="progress-bar" style="width: 0%; height: 100%; background: #1e90ff; border-radius: 5px; transition: width 0.3s;"></div>
    </div>
  </div>

  <!-- Новые слои для фона и воды -->
  <div class="background-image"></div>
  <div class="water-overlay"></div>
  <div class="water-surface"></div>

  <!-- Остальная часть HTML без изменений -->
  <!-- ... -->

  <script>
    // В функцию killCrocodile изменяем анимацию друзей:
    function killCrocodile(wrapper, croc) {
      if (gameOver) return;
      
      const rect = wrapper.getBoundingClientRect();
      const centerX = rect.left + rect.width / 2;
      const centerY = rect.top + rect.height / 2;
      
      // 1. Эффект взрыва
      const explosion = document.createElement('div');
      explosion.className = 'explosion';
      explosion.style.left = centerX + 'px';
      explosion.style.top = centerY + 'px';
      game.appendChild(explosion);
      
      // 2. Создание частиц
      for (let i = 0; i < 20; i++) {
        createParticle(centerX, centerY);
      }
      
      // 3. Водный всплеск
      createSplash(centerX, centerY);
      
      // 4. Анимация "проваливания" крокодила
      croc.style.animation = 'croc-sink 0.4s forwards';
      
      // 5. Более плавный эффект "шока" у друзей
      friends.style.animation = 'friends-shock 0.4s 1';
      setTimeout(() => {
        friends.style.animation = 'bobbing 3s infinite ease-in-out';
      }, 400);
      
      // 6. Звуковые эффекты
      if (audioEnabled) {
        punchSound.currentTime = 0;
        punchSound.play();
        boomSound.currentTime = 0;
        boomSound.play();
      }
      
      // Удаление элементов после анимации
      setTimeout(() => {
        wrapper.remove();
        explosion.remove();
        crocodiles = crocodiles.filter(c => c !== wrapper);
      }, 500);
      
      addScore(10);
      addCombo();
    }

    // Остальной JavaScript код без изменений
    // ...
  </script>
</body>
</html>